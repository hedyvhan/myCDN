---
title: 飞书多维表格函数使用
date: '2023-11-26 23:26:07(创建时间)'
tags: 飞书
categories: 飞书
abbrlink: 60210
---

# 飞书多维表格函数使用

　　最近使用飞书多维表格统计住房电费时，需要使用到函数，发现飞书云文档的函数功能有点东西，琢磨了一晚上，有些许收获，特此记录。

![image-20231126233116616](https://hedy-1321816972.cos.ap-guangzhou.myqcloud.com/img/blog202311262331708.webp)

比如，我需要统计这段时间大概每天用电多少，计算公式就是  (114-134)/30-21，在如何选中这个数据时，飞书官方给出了数据引用的示例，[链接在这里](https://www.feishu.cn/hc/zh-CN/articles/360049067909-%E5%9C%A8%E5%85%AC%E5%BC%8F%E4%B8%AD%E5%BC%95%E7%94%A8%E6%95%B0%E6%8D%AE)，官方把选中数据称为引用数据，下同。

　　对于一列数据，通过选择字段，很简单就可以选中。对于某一行的数据，需要先选择数据表，再选择字段。此时，公式字段中返回的结果为一个集合。按理说，如果是这样就很方便的解决的我的问题。选中电费得到列表[134,114]， 选中时间得到7/21、7/30对应的时间戳列表。然后通过内置函数，使用索引来选择列表中最后两个元素，进行运算操作。**但是但是**，离谱的是飞书多维表格中这样引用得到的列表，元素顺序是杂乱无章的，在官方示例演示中也可以明显看出来。

![image-20231126233931795](https://hedy-1321816972.cos.ap-guangzhou.myqcloud.com/img/blog202311262339058.webp)

这个顺序既不是按照大小排序，也不是按照录入表格的先后排序，这就导致了通过列表索引来引用元素进行运算的方法完全不可行了。

　　这是一个很简单、很常见的增速的问题，难道没有解决办法吗？在继续查阅官方文档之后，发现官方文档中有一个示例十分相似，可以借鉴，[链接在此](https://www.feishu.cn/hc/zh-CN/articles/341717871375-%E5%A4%9A%E7%BB%B4%E8%A1%A8%E6%A0%BC%E5%AE%9E%E8%B7%B5-%E5%AF%B9%E6%AF%8F%E6%9C%88%E9%94%80%E9%87%8F%E8%BF%9B%E8%A1%8C%E7%B4%AF%E5%8A%A0)。这里需要统计每个月的累计销量，即统计截止到这个月为止的所有销量。同样也是需要引用字段的一部分数据，我们那里是剩余电量字段中最后的两个数据。

![img](https://p1-hera.feishucdn.com/tos-cn-i-jbbdkfciu3/fa87e6fbbe1f4b7bb653a3b249ac70a6~tplv-jbbdkfciu3-image:0:0.image)

[销量总表].FILTER(CurrentValue.[序号]<=[序号]).[销量].SUM()

CurrentValue.序号，当前行的序号（需要引用的数据） <=  序号字段，的销量总和。

比如，统计6月的累计销量， 需要选中6月以前的数据。引用的数据的序号 <= 6的销量字段求和。巧妙的通过序号来选中需要的数据。

　　基于此，对于自己的问题，需要在前面加上序号字段，借此来选中数据。如前图所示。

![image-20231126235428094](https://hedy-1321816972.cos.ap-guangzhou.myqcloud.com/img/blog202311262354281.webp)

想要选中的数据序号<=3 并且 > 2,就选中了序号为3的这一行数据。

想要选中的数据序号<=3-1 并且 > 2-2,就选中了序号为2的这一行数据。

然后该行数据的时间相减，得到了相隔的时间。电费之差也一样。

　　最终使用同样的方法，成功的实现了上述功能。

